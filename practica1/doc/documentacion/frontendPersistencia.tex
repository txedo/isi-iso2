\paragraph{Capa de persistencia} \label{persistencia-front-end}

En esta capa, entre otras decisiones de diseño que se comentarán a continuación, se hace uso de los patrones fabricación pura, comando, agente y singleton. Para una mejor comprensión se recomienda ver el \diagrama{cliente}{clases}{Gestor Conexiones BBDD}.

Para abstraer al programador de las características específicas del lenguaje de programación empleado (Java) al realizar operaciones en la base de datos se utiliza el patrón \textbf{Comando} o \textbf{Command}, permitiéndo encapsular en una clase de más alto nivel la construcción de la sentencia que se ejecutará en la base de datos. La clase \textit{ComandoSQL} tiene dos especializaciones: \textit{ComandoSQLProcedimiento} y \textit{ComandoSQLSentencia}. De este modo, el programador únicamente deberá pasar la sentencia SQL y la lista de parámetros de número variable que hay que incrustar en ella, abstrayéndole por completo de la creación de sentencias específicas del lenguaje (\textit{PreparedStatement} y \textit{CallabeStatement}).

Para proveer de un acceso al SGBD (Sistema Gestor de Bases de Datos) se ha implementado una clase \textbf{Agente} o \textbf{Broker} junto con el patrón \textbf{Singleton}. El agente es el que inicializa, mantiene y cierra la conexión con el SGBD, manteniéndose una sola instancia de éste debido a que es singleton. De este modo se evita se evita la creación de múltiples instancias del agente para no saturar el SGBD. Además, se encarga de ejecutar las sentencias encapsuladas en el ComandoSQL. Por otro lado, nótese que implementa las acciones \textit{commit()} y \textit{rollback()}.

En referencia a la persistencia de las clases de conocimiento persistentes, se han tenido en cuenta dos alternativas: \textbf{patrón experto} y \textbf{patrón de fabricación pura}. Para ser fieles con el \underline{principio de máxima coherencia y bajo acomplamiento}, se ha descartado el patrón experto ya que se acoplarían las clases de conocimiento con la persistencia, violando así dicho principio. Por tanto se ha utilizando el patrón de fabricación pura implementando clases que tienen como única responsabilidad las operaciones CRUD (Create, Read, Update, Delete) de las clases persistentes, de tal modo que si se cambia el SGDB sólo se tendrían que cambiar el modo en que dichas clases definen las sentencias SQL, ya que la creación está delegada en el ComandoSQL. Además, cada una de estas clases de fabricación pura se encargan de acceder exclusivamente a una tabla de la base de datos, reduciendo así al máximo el acoplamiento entre clases de persistencia.